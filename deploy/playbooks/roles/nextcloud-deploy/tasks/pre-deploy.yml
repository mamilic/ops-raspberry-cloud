---

- name: Create MARIADB Volume
  file:
    path: "{{ MARIADB_VOLUME }}"
    state: directory

- name: Create NEXTCLOUD Volume
  file:
    path: "{{ NEXTCLOUD_VOLUME }}"
    state: directory

- name: Stage Docker Compose File
  template:
    src: docker-compose.yml.j2
    dest: "{{ STG_DIR }}/nextcloud-compose.yml"

- name: Create Docker Network
  docker_network:
    name: "{{ NEXTCLOUD_NETWORK }}"
    scope: swarm
    driver: overlay

- name: Pull NGINX Docker Image
  docker_image:
    name: "{{ NGINX_IMAGE }}:{{ NGINX_VERSION }}"
    source: pull
    pull:
      platform: arm64

- name: Pull MARIADB Docker Image
  docker_image:
    name: "{{ MARIADB_IMAGE }}:{{ MARIADB_VERSION }}"
    source: pull
    pull:
      platform: arm64

- name: Pull REDIS Docker Image
  docker_image:
    name: "{{ REDIS_IMAGE }}:{{ REDIS_VERSION }}"
    source: pull
    pull:
      platform: arm64

- name: Pull NEXTCLOUD Docker Image
  docker_image:
    name: "{{ NEXTCLOUD_IMAGE }}:{{ NEXTCLOUD_VERSION }}"
    source: pull
    pull:
      platform: arm64

- name: Pull COLLABORA Docker Image
  docker_image:
    name: "{{ COLLABORA_IMAGE }}:{{ COLLABORA_VERSION }}"
    source: pull
    pull:
      platform: arm64